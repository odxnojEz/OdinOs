<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Calculadora de IMC</title>
  <style>
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial; color:#111}
    body{display:flex;align-items:center;justify-content:center;min-height:100vh;margin:0;background:#f4f6fb}
    .card{background:white;padding:20px;border-radius:10px;box-shadow:0 6px 18px rgba(20,30,60,0.08);width:340px}
    h1{font-size:18px;margin:0 0 14px}
    label{display:block;font-size:13px;margin:8px 0 6px}
    .row{display:flex;gap:8px}
    input[type="number"]{flex:1;padding:10px;border:1px solid #d6dce9;border-radius:6px;font-size:14px}
    select{padding:10px;border:1px solid #d6dce9;border-radius:6px;background:white;font-size:14px}
    button{margin-top:12px;width:100%;padding:10px;border:0;background:#2b6ef6;color:white;border-radius:8px;font-weight:600;cursor:pointer}
    .result{margin-top:14px;padding:10px;border-radius:8px;background:#f1f5ff;border:1px solid #dbe7ff}
    .bmi-value{font-size:20px;font-weight:700}
    .category{font-weight:600;margin-top:6px}
    .small{font-size:13px;color:#444;margin-top:8px}
    .danger{background:#fff1f0;border-color:#ffd6d6}
    .good{background:#f0fff6;border-color:#d6ffe5}
    .warn{background:#fff9ec;border-color:#fff1d6}
  </style>
</head>
<body>
  <div class="card" role="application" aria-label="Calculadora de IMC">
    <h1>Calculadora de IMC (Índice de Masa Corporal)</h1>

    <label for="peso">Peso</label>
    <div class="row">
      <input id="peso" type="number" min="0" step="0.1" placeholder="Ej. 70" aria-label="Peso">
      <select id="unidad-peso" aria-label="Unidad de peso">
        <option value="kg">kg</option>
        <option value="lb">lb (libras)</option>
      </select>
    </div>

    <label for="altura">Altura</label>
    <div class="row">
      <input id="altura" type="number" min="0" step="0.1" placeholder="Ej. 1.75 o 175" aria-label="Altura">
      <select id="unidad-altura" aria-label="Unidad de altura">
        <option value="m">m (metros)</option>
        <option value="cm">cm (centímetros)</option>
      </select>
    </div>

    <button id="calcular">Calcular IMC</button>

    <div id="resultado" class="result" aria-live="polite" style="display:none">
      <div class="bmi-value" id="valor-imc"></div>
      <div class="category" id="categoria-imc"></div>
      <div class="small">IMC = peso (kg) / altura (m)²</div>
    </div>
  </div>

  <script>
    const pesoInput = document.getElementById('peso');
    const alturaInput = document.getElementById('altura');
    const unidadPeso = document.getElementById('unidad-peso');
    const unidadAltura = document.getElementById('unidad-altura');
    const btn = document.getElementById('calcular');
    const resultado = document.getElementById('resultado');
    const valorImc = document.getElementById('valor-imc');
    const categoriaImc = document.getElementById('categoria-imc');
    const cardResult = document.querySelector('.result');

    function mostrarError(text) {
      resultado.style.display = 'block';
      valorImc.textContent = 'Entrada inválida';
      categoriaImc.textContent = text || 'Comprueba los valores.';
      cardResult.className = 'result danger';
    }

    function clasificarIMC(imc) {
      // Clasificación basada en criterios habituales (WHO)
      if (imc < 18.5) return {text: 'Bajo peso', style: 'danger'};
      if (imc < 25) return {text: 'Peso normal', style: 'good'};
      if (imc < 30) return {text: 'Sobrepeso', style: 'warn'};
      // obesidad subdividida
      if (imc < 35) return {text: 'Obesidad (grado I)', style: 'danger'};
      if (imc < 40) return {text: 'Obesidad (grado II)', style: 'danger'};
      return {text: 'Obesidad (grado III)', style: 'danger'};
    }

    btn.addEventListener('click', () => {
      const pesoRaw = parseFloat(pesoInput.value);
      const alturaRaw = parseFloat(alturaInput.value);

      if (!pesoRaw || pesoRaw <= 0) { mostrarError('Introduce un peso válido mayor que 0.'); return; }
      if (!alturaRaw || alturaRaw <= 0) { mostrarError('Introduce una altura válida mayor que 0.'); return; }

      // convertir peso a kg
      let pesoKg = pesoRaw;
      if (unidadPeso.value === 'lb') pesoKg = pesoRaw * 0.45359237;

      // convertir altura a metros
      let alturaM = alturaRaw;
      if (unidadAltura.value === 'cm') alturaM = alturaRaw / 100;

      if (alturaM <= 0) { mostrarError('Altura inválida después de convertir unidades.'); return; }

      const imc = pesoKg / (alturaM * alturaM);
      if (!isFinite(imc) || imc <= 0) { mostrarError('Cálculo del IMC no válido.'); return; }

      const imcRedondeado = Math.round(imc * 100) / 100; // dos decimales
      const categoria = clasificarIMC(imc);

      // mostrar resultado
      resultado.style.display = 'block';
      valorImc.textContent = 'IMC: ' + imcRedondeado.toFixed(2);
      categoriaImc.textContent = categoria.text;
      // aplicar estilo
      cardResult.className = 'result ' + categoria.style;
    });

    // permitir calcular con Enter en cualquier input
    [pesoInput, alturaInput].forEach(inp => inp.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') btn.click();
    }));
  </script>
</body>
</html>